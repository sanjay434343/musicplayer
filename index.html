<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Tamil Music - Spotify</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      background: #121212;
      color: #ffffff;
      font-family: 'Helvetica Neue', Arial, sans-serif;
      height: 100vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    
    /* Top Navigation */
    .top-nav {
      background: #121212;
      padding: 16px 24px;
      border-bottom: 1px solid #282828;
      display: flex;
      align-items: center;
      gap: 16px;
      z-index: 100;
    }
    
    .nav-buttons {
      display: flex;
      gap: 8px;
    }
    
    .nav-btn {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: #0a0a0a;
      border: none;
      color: #ffffff;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      transition: background 0.2s;
    }
    
    .nav-btn:hover {
      background: #1a1a1a;
    }
    
    .nav-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }
    
    .search-bar {
      flex: 1;
      max-width: 400px;
      position: relative;
    }
    
    .search-input {
      width: 100%;
      background: #242424;
      border: none;
      border-radius: 24px;
      padding: 12px 16px 12px 48px;
      color: #ffffff;
      font-size: 14px;
      transition: background 0.2s;
    }
    
    .search-input:focus {
      outline: none;
      background: #2a2a2a;
    }
    
    .search-icon {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: #b3b3b3;
      font-size: 16px;
    }
    
    /* Main Content */
    .main-content {
      flex: 1;
      display: flex;
      overflow: hidden;
    }
    
    /* Sidebar */
    .sidebar {
      width: 280px;
      background: #121212;
      border-right: 1px solid #282828;
      display: flex;
      flex-direction: column;
    }
    
    .sidebar-header {
      padding: 24px;
      border-bottom: 1px solid #282828;
    }
    
    .logo {
      height: 32px;
      margin-bottom: 20px;
    }
    
    .sidebar-nav {
      padding: 8px 0;
    }
    
    .sidebar-item {
      padding: 12px 24px;
      color: #b3b3b3;
      font-weight: 500;
      font-size: 14px;
      cursor: pointer;
      transition: color 0.2s;
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .sidebar-item.active {
      color: #ffffff;
    }
    
    .sidebar-item:hover {
      color: #ffffff;
    }
    
    /* Main View */
    .main-view {
      flex: 1;
      background: linear-gradient(180deg, #1e3264 0%, #121212 300px);
      overflow-y: auto;
      padding: 24px;
      padding-bottom: 120px; /* Space for bottom player */
    }
    
    .playlist-header {
      margin-bottom: 32px;
    }
    
    .playlist-title {
      font-size: 48px;
      font-weight: 900;
      margin-bottom: 8px;
    }
    
    .playlist-meta {
      color: #b3b3b3;
      font-size: 14px;
    }
    
    /* Songs Table */
    .songs-table {
      width: 100%;
    }
    
    .songs-header {
      display: grid;
      grid-template-columns: 16px 1fr 1fr auto;
      gap: 16px;
      padding: 8px 16px;
      border-bottom: 1px solid #282828;
      margin-bottom: 16px;
      font-size: 12px;
      color: #b3b3b3;
      font-weight: 500;
      text-transform: uppercase;
    }
    
    .song-row {
      display: grid;
      grid-template-columns: 16px 1fr 1fr auto;
      gap: 16px;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.2s;
      align-items: center;
      min-height: 56px;
    }
    
    .song-row:hover {
      background: #1a1a1a;
    }
    
    .song-row.active {
      background: #1a1a1a;
    }
    
    .song-index {
      color: #b3b3b3;
      font-size: 14px;
      text-align: center;
    }
    
    .song-row:hover .song-index {
      display: none;
    }
    
    .song-row:hover .play-icon {
      display: block;
    }
    
    .play-icon {
      display: none;
      color: #ffffff;
      font-size: 16px;
    }
    
    .song-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .song-cover-small {
      width: 40px;
      height: 40px;
      border-radius: 4px;
      object-fit: cover;
      background: #282828;
    }
    
    .song-details {
      min-width: 0;
    }
    
    .song-name {
      font-size: 16px;
      font-weight: 500;
      color: #ffffff;
      margin-bottom: 2px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .song-artist {
      font-size: 14px;
      color: #b3b3b3;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .song-album {
      color: #b3b3b3;
      font-size: 14px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .song-duration {
      color: #b3b3b3;
      font-size: 14px;
    }
    
    /* Bottom Player */
    .bottom-player {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #181818;
      border-top: 1px solid #282828;
      padding: 12px 16px;
      display: grid;
      grid-template-columns: 1fr 2fr 1fr;
      gap: 16px;
      align-items: center;
      z-index: 1000;
      height: 90px;
    }
    
    .now-playing {
      display: flex;
      align-items: center;
      gap: 12px;
      min-width: 0;
    }
    
    .now-playing-cover {
      width: 56px;
      height: 56px;
      border-radius: 4px;
      object-fit: cover;
      background: #282828;
      flex-shrink: 0;
    }
    
    .now-playing-info {
      min-width: 0;
      flex: 1;
    }
    
    .now-playing-name {
      font-size: 14px;
      font-weight: 500;
      color: #ffffff;
      margin-bottom: 2px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .now-playing-artist {
      font-size: 12px;
      color: #b3b3b3;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .like-btn {
      background: none;
      border: none;
      color: #b3b3b3;
      cursor: pointer;
      padding: 8px;
      margin-left: 8px;
      border-radius: 50%;
      transition: color 0.2s;
    }
    
    .like-btn:hover {
      color: #ffffff;
    }
    
    .player-controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }
    
    .control-buttons {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .control-btn {
      background: none;
      border: none;
      color: #b3b3b3;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: color 0.2s, transform 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .control-btn:hover {
      color: #ffffff;
      transform: scale(1.06);
    }
    
    .play-pause-btn {
      width: 32px;
      height: 32px;
      background: #ffffff;
      color: #000000;
      font-size: 12px;
    }
    
    .play-pause-btn:hover {
      background: #ffffff;
      color: #000000;
      transform: scale(1.06);
    }
    
    .progress-bar {
      display: flex;
      align-items: center;
      gap: 8px;
      width: 100%;
      max-width: 600px;
    }
    
    .time-display {
      font-size: 11px;
      color: #b3b3b3;
      min-width: 40px;
      text-align: center;
    }
    
    .progress-track {
      flex: 1;
      height: 4px;
      background: #4f4f4f;
      border-radius: 2px;
      cursor: pointer;
      position: relative;
    }
    
    .progress-filled {
      height: 100%;
      background: #ffffff;
      border-radius: 2px;
      width: 30%;
      transition: width 0.1s;
    }
    
    .volume-controls {
      display: flex;
      align-items: center;
      gap: 8px;
      justify-self: end;
    }
    
    .volume-btn {
      background: none;
      border: none;
      color: #b3b3b3;
      cursor: pointer;
      padding: 8px;
    }
    
    .volume-slider {
      width: 100px;
      height: 4px;
      background: #4f4f4f;
      border-radius: 2px;
      cursor: pointer;
    }
    
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 200px;
      color: #b3b3b3;
    }
    
    .error {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 200px;
      color: #f77;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .sidebar {
        display: none;
      }
      
      .bottom-player {
        grid-template-columns: 1fr auto;
      }
      
      .volume-controls {
        display: none;
      }
    }
    
    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 12px;
    }
    
    ::-webkit-scrollbar-track {
      background: #121212;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #333333;
      border-radius: 6px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #444444;
    }
  </style>
</head>
<body>
  <!-- Top Navigation -->
  <nav class="top-nav">
    <div class="nav-buttons">
      <button class="nav-btn" onclick="history.back()" title="Go back">‚Äπ</button>
      <button class="nav-btn" onclick="history.forward()" title="Go forward">‚Ä∫</button>
    </div>
    <div class="search-bar">
      <span class="search-icon">üîç</span>
      <input type="text" class="search-input" id="searchInput" placeholder="What do you want to listen to?" value="tamil">
    </div>
  </nav>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <img src="https://storage.googleapis.com/pr-newsroom-wp/1/2018/11/Spotify_Logo_CMYK_White.png" alt="Spotify" class="logo">
      </div>
      <nav class="sidebar-nav">
        <div class="sidebar-item active">
          <span>üè†</span> Home
        </div>
        <div class="sidebar-item">
          <span>üîç</span> Search
        </div>
        <div class="sidebar-item">
          <span>üìö</span> Your Library
        </div>
      </nav>
    </div>

    <!-- Main View -->
    <div class="main-view" id="mainView">
      <div class="playlist-header">
        <h1 class="playlist-title">Tamil Songs</h1>
        <div class="playlist-meta">
          <span id="songsCount">Loading...</span> songs
        </div>
      </div>

      <div class="songs-table">
        <div class="songs-header">
          <span>#</span>
          <span>Title</span>
          <span>Album</span>
          <span>‚è±</span>
        </div>
        <div id="songsList"></div>
      </div>
    </div>
  </div>

  <!-- Bottom Player -->
  <div class="bottom-player" id="bottomPlayer" style="display: none;">
    <div class="now-playing">
      <img class="now-playing-cover" id="nowPlayingCover" src="" alt="">
      <div class="now-playing-info">
        <div class="now-playing-name" id="nowPlayingName">Select a song</div>
        <div class="now-playing-artist" id="nowPlayingArtist">Artist</div>
      </div>
      <button class="like-btn" title="Add to Liked Songs">‚ô°</button>
    </div>

    <div class="player-controls">
      <div class="control-buttons">
        <button class="control-btn" onclick="shuffle()" title="Shuffle">üîÄ</button>
        <button class="control-btn" onclick="prevSong()" title="Previous">‚èÆ</button>
        <button class="control-btn play-pause-btn" id="playPauseBtn" onclick="togglePlay()">‚ñ∂</button>
        <button class="control-btn" onclick="nextSong()" title="Next">‚è≠</button>
        <button class="control-btn" onclick="repeat()" title="Repeat">üîÅ</button>
      </div>
      <div class="progress-bar">
        <span class="time-display" id="currentTime">0:00</span>
        <div class="progress-track" onclick="seek(event)">
          <div class="progress-filled" id="progressFilled"></div>
        </div>
        <span class="time-display" id="totalTime">0:00</span>
      </div>
    </div>

    <div class="volume-controls">
      <button class="volume-btn">üîä</button>
      <div class="volume-slider"></div>
    </div>
  </div>

  <audio id="audioPlayer" style="display: none;"></audio>

  <script>
    const API_URL = "https://jiosavan-api-with-playlist.vercel.app/api/search/songs?query=";
    
    let songs = [];
    let currentIdx = 0;
    let isPlaying = false;
    let audio = null;

    const songsListDiv = document.getElementById("songsList");
    const searchInput = document.getElementById("searchInput");
    const bottomPlayer = document.getElementById("bottomPlayer");
    const nowPlayingCover = document.getElementById("nowPlayingCover");
    const nowPlayingName = document.getElementById("nowPlayingName");
    const nowPlayingArtist = document.getElementById("nowPlayingArtist");
    const playPauseBtn = document.getElementById("playPauseBtn");
    const currentTime = document.getElementById("currentTime");
    const totalTime = document.getElementById("totalTime");
    const progressFilled = document.getElementById("progressFilled");
    const songsCount = document.getElementById("songsCount");

    function fetchSongs(query) {
      songsListDiv.innerHTML = '<div class="loading">Loading Tamil songs...</div>';
      
      fetch(`${API_URL}${encodeURIComponent(query)}&limit=100`)
        .then(res => res.json())
        .then(json => {
          songs = (json.data.results || []).filter(
            s => s.language && s.language.toLowerCase() === "tamil"
          ) || [];
          
          currentIdx = 0;
          renderSongsList();
          songsCount.textContent = songs.length;
        })
        .catch(error => {
          console.error('Error fetching songs:', error);
          songsListDiv.innerHTML = '<div class="error">Failed to load songs. Please try again.</div>';
        });
    }

    function renderSongsList() {
      if (!songs.length) {
        songsListDiv.innerHTML = '<div class="loading">No Tamil songs found</div>';
        return;
      }

      songsListDiv.innerHTML = "";
      songs.forEach((song, idx) => {
        const songRow = document.createElement("div");
        songRow.className = "song-row" + (idx === currentIdx && isPlaying ? " active" : "");
        songRow.onclick = () => playSong(idx);
        
        songRow.innerHTML = `
          <div class="song-index">${idx + 1}</div>
          <div class="song-info">
            <img class="song-cover-small" src="${getImg(song, '150x150')}" alt="">
            <div class="song-details">
              <div class="song-name">${song.name}</div>
              <div class="song-artist">${song.artists.primary.map(a => a.name).join(", ")}</div>
            </div>
          </div>
          <div class="song-album">${song.album.name}</div>
          <div class="song-duration">${formatDuration(song.duration)}</div>
        `;
        
        songsListDiv.appendChild(songRow);
      });
    }

    function playSong(idx) {
      currentIdx = idx;
      isPlaying = true;
      
      const song = songs[currentIdx];
      
      // Update bottom player
      bottomPlayer.style.display = 'grid';
      nowPlayingCover.src = getImg(song, '500x500');
      nowPlayingName.textContent = song.name;
      nowPlayingArtist.textContent = song.artists.primary.map(a => a.name).join(", ");
      playPauseBtn.innerHTML = '‚è∏';
      
      // Update songs list
      renderSongsList();
      
      // Setup audio
      setupAudioPlayer(song);
    }

    function setupAudioPlayer(song) {
      audio = document.getElementById("audioPlayer");
      if (!audio) return;
      
      let url = "";
      if (song.downloadUrl && Array.isArray(song.downloadUrl)) {
        let high = song.downloadUrl.find(d => d.quality === "320kbps");
        url = high ? high.url : song.downloadUrl[song.downloadUrl.length - 1]?.url;
      }
      
      if (url) {
        audio.src = url;
        audio.onended = nextSong;
        audio.ontimeupdate = updateProgress;
        audio.onloadedmetadata = () => {
          totalTime.textContent = formatDuration(Math.floor(audio.duration));
        };
        
        if (isPlaying) {
          audio.play().catch(console.error);
        }
      }
    }

    function togglePlay() {
      if (!songs[currentIdx]) return;
      
      isPlaying = !isPlaying;
      playPauseBtn.innerHTML = isPlaying ? '‚è∏' : '‚ñ∂';
      
      if (audio) {
        if (isPlaying) {
          audio.play().catch(console.error);
        } else {
          audio.pause();
        }
      }
      
      renderSongsList();
    }

    function nextSong() {
      if (!songs.length) return;
      currentIdx = (currentIdx + 1) % songs.length;
      playSong(currentIdx);
    }

    function prevSong() {
      if (!songs.length) return;
      currentIdx = (currentIdx - 1 + songs.length) % songs.length;
      playSong(currentIdx);
    }

    function updateProgress() {
      if (!audio) return;
      
      const progress = (audio.currentTime / audio.duration) * 100;
      progressFilled.style.width = progress + '%';
      currentTime.textContent = formatDuration(Math.floor(audio.currentTime));
    }

    function seek(event) {
      if (!audio) return;
      
      const rect = event.target.getBoundingClientRect();
      const percent = (event.clientX - rect.left) / rect.width;
      audio.currentTime = percent * audio.duration;
    }

    function shuffle() {
      // Placeholder for shuffle functionality
      console.log('Shuffle clicked');
    }

    function repeat() {
      // Placeholder for repeat functionality
      console.log('Repeat clicked');
    }

    function formatDuration(seconds) {
      if (!seconds || isNaN(seconds)) return "0:00";
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60).toString().padStart(2, "0");
      return `${mins}:${secs}`;
    }

    function getImg(song, quality) {
      if (!song.image || !song.image.length) return "";
      return song.image.find(img => img.quality === quality)?.url || song.image[0].url;
    }

    // Search handling
    searchInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        fetchSongs(searchInput.value.trim() || 'tamil');
      }
    });

    // Make functions globally available
    window.togglePlay = togglePlay;
    window.nextSong = nextSong;
    window.prevSong = prevSong;
    window.shuffle = shuffle;
    window.repeat = repeat;
    window.seek = seek;

    // Initial load
    fetchSongs("tamil");
  </script>
</body>
</html>
